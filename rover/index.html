<!DOCTYPE html>
<html>
<head>
    
  <!-- set charset -->
  <meta charset="UTF-8"/>

  <!-- Viewport meta tag -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Description meta tag -->
  <meta name="description" content="Link Rover is a tool created by Fahad Alamgir Dhruba." />

  <!-- Keywords meta tag -->
  <meta name="keywords" content="Google Drive, link, viewable, downloadable, Fahad Alamgir Dhruba, Link Rover" />

  <!-- Author meta tag -->
  <meta name="author" content="Fahad Alamgir Dhruba" />

  <!-- Canonical link tag -->
  <link rel="canonical" href="https://linkrover.netlify.app/" />

  <!-- Open Graph tags -->
  <meta property="og:title" content="Link Rover V3" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://linkrover.netlify.app/" />
  <meta property="og:image" content="https://linkrover.netlify.app/images/logo.png" /> 
  <meta property="og:description" content="Link Rover is a tool created by Fahad Alamgir Dhruba." />

  <!-- Twitter card tags -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Link Rover V3" />
  <meta name="twitter:description" content="Link Rover is a tool created by Fahad Alamgir Dhruba." /> 
  <meta name="twitter:image" content="https://linkrover.netlify.app/images/logo.png" />
  <meta name="twitter:url" content="https://linkrover.netlify.app/" />

  <!-- WhatsApp meta tags -->
  <meta name="whatsapp:description" content="Link Rover is a tool created by Fahad Alamgir Dhruba." />
  <meta name="whatsapp:title" content="Link Rover V3" />
  <meta name="whatsapp:image" content="https://linkrover.netlify.app/images/logo.png"/>
  <meta name="whatsapp:url" content="https://linkrover.netlify.app/" />

  <!-- Favicon -->
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />

  <!-- External javascript and css files -->
  <script src="https://cdn.tailwindcss.com"></script>
    
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
  
  <!-- title -->
  <title>Link Rover 3.O</title>
</head>

  <body class="bg-slate-200 dark:bg-gray-700">

    <nav class="bg-white border-gray-200 dark:bg-gray-900">
      <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto px-4 py-2">
          <a href="https://linkrover.netlify.app/" class="flex items-center space-x-3 rtl:space-x-reverse">
          <img src="images/logo.png" class="h-8" alt=" Logo" />
          <span class="m-1 self-center text-lg font-semibold whitespace-nowrap dark:text-white">Link Rover</span>
          </a>
          <button id="dropbtn" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-default" aria-expanded="false">
              <span class="sr-only">Open main menu</span>
              <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14">
                  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"/>
              </svg>
          </button>
          <!--- Drop down Bar ---->
          <div class="hidden w-full md:block md:w-auto" id="dropid">
              <ul class="font-medium flex flex-col p-2 md:p-0 mt-1 rounded-lg md:flex-row md:space-x-8 md:mt-0">
                  <li>
                      <a href="../rover/" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent">Rover</a>
                  </li>
                  <li>
                      <a href="../view/" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent">Rovered Links</a>
                  </li>
                  <li>
                      <a href="../tskm/" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent">Task Manager</a>
                  </li>
              </ul>
          </div>
      </div>
    </nav>



    <div class="bg-slate-200 dark:bg-gray-700 p-2 my-36 w-full max-w-md mx-auto" id="wrapper">
      <div id="urlbox">
        <div class="p-4">
          <label
            for="url"
            class="mb-2 text-sm font-medium text-gray-900 sr-only"
            >Enter Drive Url Here!</label
          >
          <div class="relative">
            <input
              type="text"
              id="url"
              name="url"
              class="block w-full p-4 pr-16 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-4 focus:ring-green-100 dark:focus:ring-blue-100"
              placeholder="Enter Drive Url Here!"
              onfocus="this.select()"
              autocomplete="off"
              required
            />
            <button
              type="button"
              id="btn"
              class="text-gray-800 absolute right-2.5 bottom-2.5 bg-gray-400 hover:bg-gray-500 focus:ring-4 focus:outline-none focus:ring-blue-200 font-medium rounded-lg text-sm px-4 py-2"
            >
              <i class="fas fa-arrow-right"></i>
            </button>
          </div>
        </div>
      </div>

      <div id="copybox">
        <div class="p-4">
          <label
            for="Result"
            class="mb-2 text-sm font-medium text-gray-900 sr-only"
            >Enter Url</label
          >
          <div class="relative">
            <input
              type="text"
              id="result"
              name="result"
              class="block w-full p-4 pr-16 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"
              placeholder=""
              onfocus="this.select()"
              autocomplete="off"
              required
            />

            <button
              type="button"
              id="copybtn"
              class="text-gray-800 absolute right-2.5 bottom-2.5 bg-gray-400 hover:bg-gray-500 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2"
            >
              <i class="fas fa-copy"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    
    


<footer class="fixed text-gray-800 dark:text-gray-100 py-4 bottom-0 w-full">
  <div class="container mx-auto text-center">
      <p class="text-sm">&copy; 2023 <a href="https://github.com/FahadDhruba/" class="hover:underline">Fahad Alamgir Dhruba</a>. All rights reserved.</p>
  </div>
</footer>

    <script src="src/script.js"></script>

    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-analytics.js";
      import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-database.js";
      import { getAuth, signInWithPopup, GoogleAuthProvider, signInWithRedirect, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-auth.js";

      const firebaseConfig = {
        apiKey: "AIzaSyD0z9y5NuCs2OTHo5akeIV5-hQYRvpOXmE",
        authDomain: "link-rover-3.firebaseapp.com",
        databaseURL: "https://link-rover-3-default-rtdb.firebaseio.com",
        projectId: "link-rover-3",
        storageBucket: "link-rover-3.appspot.com",
        messagingSenderId: "715683693672",
        appId: "1:715683693672:web:0d86f9370a7949095727dd",
        measurementId: "G-CPTVR03Q63",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);

      //Initialise Database

      const db = getDatabase(app);

      // auth setup
      
      const auth = getAuth();
      
      auth.languageCode = "it";

      const provider = new GoogleAuthProvider();

      // Check user signed in or not

      onAuthStateChanged(auth, (user) => {
        if (user) {
          
          // User is signed in
          
          const uid = user.uid;
          // ...

          console.log("signed");

        } else {
          
          // User is signed out
          
          console.log("no");
          window.location.href = "../signin/"

        }
      });


      //Make a Function to Upload Data

      function webupdt(fileId, url, sUrl, type) {
        const options = {
          year: 'numeric',
          month: 'short',
          day: 'numeric',
          hour: 'numeric',
          minute: 'numeric',
          second: 'numeric',
          hour12: true,
        };
        const d = new Date();
        let uc = d.getTime();
        let web = window.location.href;
        set(ref(db, "webNetlify3/" + uc), {
          title: fileId,
          mLink: url,
          sLink: sUrl,
          time: d.toLocaleString('en-US', options),
          webService: web,
          type: type,
        });
      }

      //Main Code That I Meant For


      //Main Function

      function convertURL(url) {
        const regex = /https:\/\/(docs|drive)\.google\.com\/(document|presentation|spreadsheets|file)\/d\/([a-zA-Z0-9_-]+)/;
        const match = url.match(regex);

        if (!match) {
          let errorID = "Error: Invalid URL";
          alert(errorID);
          document.getElementById("url").value = "";
          return;
        }

        const baseURL = "https://drive.google.com/file/d/";
        const fileId = match[3];
        let sUrl = baseURL + fileId + "/";
        let type = match[2];

        //Database Uploader Call of Function

        webupdt(fileId, url, sUrl, type);

        return sUrl;
      }

      //Designer Function
      
      function convert() {
        const url = document.getElementById("url").value;
        const result = convertURL(url);
        if (result) {
          document.getElementById("result").value = result;
          document.getElementById("copybox").style.display = "block";
          document.getElementById("copybox").style.transition =
            "opacity 1s ease-in-out";
          document.getElementById("copybox").style.opacity = 0;

          setTimeout(function () {
            document.getElementById("copybox").style.opacity = 1;
          }, 100);
        }
      }

      document.getElementById("copybtn").addEventListener("click", function () {
        // Select the content of the input box
        document.getElementById("result").select();
        // Copy the selected content
        document.execCommand("copy");
        console.log(">_ copied");
      });

      // Listen for changes to the input element
      document.getElementById("url").addEventListener("input", function () {
        // Hide the div with the id "copybox"
        document.getElementById("copybox").style.display = "none";
      });

      document.getElementById("btn").addEventListener("click", convert);
    </script>
  </body>
</html>
